<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Supabase – Listar Imagens</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
body{margin:0;padding:20px;background:#0b1020;color:#e5e7eb;font-family:Arial}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;margin-top:16px}
img{width:100%;height:180px;object-fit:cover;border:1px solid #374151;background:#111827}
#status{font-size:12px;color:#9ca3af}
</style>
</head>
<body>

<h2>Imagens do Supabase</h2>
<div id="status">Carregando…</div>
<div id="grid" class="grid"></div>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://azjqiouvwpazbpzvjlhe.supabase.co";
const SUPABASE_KEY = "sb_publishable_yINVCFwIqlNc9ropYuZxDg_eiJNDhsz";

/*
  ⚠️ ESTE É O NOME DO BUCKET
  Se não aparecer nada, troque para:
  "imagens", "comprovantes", "uploads", etc
*/
const BUCKET = "images";

const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const grid = document.getElementById("grid");
const status = document.getElementById("status");

function publicUrl(path){
  return `${SUPABASE_URL}/storage/v1/object/public/${BUCKET}/${path}`;
}

async function listar(){
  status.textContent = "Buscando arquivos no bucket '" + BUCKET + "'…";

  const { data, error } = await supabase
    .storage
    .from(BUCKET)
    .list("", { limit: 1000 });

  if(error){
    status.textContent = "ERRO: " + error.message;
    return;
  }

  if(!data || data.length === 0){
    status.textContent = "Nenhum arquivo encontrado no bucket '" + BUCKET + "'.";
    return;
  }

  status.textContent = "Encontrados " + data.length + " arquivos.";

  for(const file of data){
    if(!file.name.match(/\.(jpg|jpeg|png|webp|gif|svg)$/i)) continue;

    const img = document.createElement("img");
    img.src = publicUrl(file.name);
    grid.appendChild(img);
  }
}

listar();
</script>
</body>
</html>
